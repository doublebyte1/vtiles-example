<html>
<head><title>OGC API - Tiles Styling</title></head>
<body>
<div id="map" style="width:100vw;height:100vh;"></div>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.3/dist/leaflet.css"/>
<script type="text/javascript" src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js"></script>
<script type="text/javascript" src="https://unpkg.com/leaflet.vectorgrid@1.3.0/dist/Leaflet.VectorGrid.bundled.js"></script>
<script>

map = L.map('map').setView({ lng: 126.8093305, lat: 37.5647616 }, 7);

/*
map.addLayer(
    new L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
    subdomains: 'abcd',
    minZoom: 1,
    maxZoom: 16,
    ext: 'jpg'
    }));
*/

map.addLayer(
    new L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer/tile/{z}/{y}/{x}', {
	attribution: 'Tiles &copy; Esri &mdash; National Geographic, Esri, DeLorme, NAVTEQ, UNEP-WCMC, USGS, NASA, ESA, METI, NRCAN, GEBCO, NOAA, iPC',
	maxZoom: 16,
    ext: 'jpg'
    }));

// map.addLayer(
//     new L.tileLayer('https://tiles.stadiamaps.com/tiles/stamen_watercolor/{z}/{x}/{y}.jpg', {
//     attribution: '&copy; <a href="https://stadiamaps.com/" target="_blank">Stadia Maps</a>, &copy; <a href="https://openmaptiles.org/" target="_blank">OpenMapTiles</a> &copy; <a href="https://www.openstreetmap.org/about" target="_blank">OpenStreetMap</a> contributors',
//     minZoom: 1,
//     maxZoom: 20
//     }));


var vectorTileStyling = {
    meta: function(properties) {
        return ({
            fill: true,
            fillColor: "#ffffff",
            fillOpacity: 0.0,
            weight: 0,
            color: "green",
            opacity: 0.0,
        });
    },
    hits: function(properties) {
        return ({
            fill: true,
            fillColor: "#E77084",
            fillOpacity: 0.8,
            weight: 1,
            color: "yellow",
            opacity: 0.9,
        });
    }
}

var mapVectorTileOptions = {
    rendererFactory: L.canvas.tile,
    interactive: true,
    // maxNativeZoom: 11,
    //  minZoom: 9,
    vectorTileLayerStyles: vectorTileStyling,
};

//var pbfURL='http://localhost:5000/collections/ne_110m_populated_places_simple/tiles/WorldCRS84Quad/{z}/{x}/{y}?f=mvt';
var pbfURL='http://localhost:5000/collections/roads_korea/tiles/WorldCRS84Quad/{z}/{x}/{y}?f=mvt';



// var pbfLayer=L.vectorGrid.protobuf(pbfURL,mapVectorTileOptions).on('click',function(e) {
//     console.log(e.layer);
//     L.DomEvent.stop(e);
// }).addTo(map); 


(async () => {
      const border = await fetch('http://localhost:5000/collections/roads_korea/items?limit=100000', {
        headers: {
          'Accept': 'application/geo+json'
        }
      }).then(response => response.json());
      
      L.geoJSON(border).addTo(map);

    })();



</script>
</body>
</html>