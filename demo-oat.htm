<html>
<head><title>OGC API - Tiles Styling</title></head>
<body>
<div id="map" style="width:100vw;height:100vh;"></div>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.3/dist/leaflet.css"/>
<script type="text/javascript" src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js"></script>
<script type="text/javascript" src="https://unpkg.com/leaflet.vectorgrid@1.3.0/dist/Leaflet.VectorGrid.bundled.js"></script>
<script>
map = L.map('map').setView({ lng: -17.0070743, lat: 32.6601593 }, 9);
map.addLayer(
    new L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
    subdomains: 'abcd',
    minZoom: 1,
    maxZoom: 16,
    ext: 'jpg'
    }));

var vectorTileStyling = {
    meta: function(properties) {
        return ({
            fill: true,
            fillColor: "#ffffff",
            fillOpacity: 0.0,
            weight: 1,
            color: "green",
            opacity: 0.8,
        });
    },
    hits: function(properties) {
        return ({
            fill: true,
            fillColor: "#E77084",
            fillOpacity: 0.8,
            weight: 1,
            color: "red",
            opacity: 0.9,
        });
    }
}

var mapVectorTileOptions = {
    rendererFactory: L.canvas.tile,
    interactive: true,
    // maxNativeZoom: 11,
    // minZoom: 4,
    vectorTileLayerStyles: vectorTileStyling,
};

//var pbfURL='http://localhost:9200/arqmadeira_nutsi_caop2022,ef_aguasbalneares/_mvt/geometry/{z}/{x}/{y}?&grid_precision=0';
var pbfURL='http://localhost:5000/collections/arqmadeira_nutsi_caop2022/tiles/WorldCRS84Quad/{z}/{x}/{y}?f=mvt';

var pbfLayer=L.vectorGrid.protobuf(pbfURL,mapVectorTileOptions).on('click',function(e) {
    console.log(e.layer);
    L.DomEvent.stop(e);
}).addTo(map); 


// (async () => {
//       const border = await fetch('http://localhost:5000/collections/arqmadeira_nutsi_caop2022/items?limit=1000', {
//         headers: {
//           'Accept': 'application/geo+json'
//         }
//       }).then(response => response.json());
      
//       L.geoJSON(border).addTo(map);

//     })();



</script>
</body>
</html>